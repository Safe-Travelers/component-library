{"version":3,"file":"FormLocation.stories.a3796b92.js","sources":["../../node_modules/use-places-autocomplete/dist/index.esm.js","../../src/component/form/form-location/FormLocation.tsx"],"sourcesContent":["import { useRef, useState, useCallback, useEffect } from 'react';\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nvar useLatest = (function (val) {\n  var ref = useRef(val);\n  ref.current = val;\n  return ref;\n});\n\nvar _debounce = (function (fn, delay) {\n  var timer; // eslint-disable-next-line func-names\n\n  return function () {\n    var _this = this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (timer !== null) {\n      clearTimeout(timer);\n      timer = null;\n    }\n\n    timer = setTimeout(function () {\n      return fn.apply(_this, args);\n    }, delay);\n  };\n});\n\nvar loadApiErr = \"ðŸ’¡ use-places-autocomplete: Google Maps Places API library must be loaded. See: https://github.com/wellyshen/use-places-autocomplete#load-the-library\";\n\nvar usePlacesAutocomplete = function usePlacesAutocomplete(_temp) {\n  var _ref = _temp === void 0 ? {} : _temp,\n      requestOptions = _ref.requestOptions,\n      _ref$debounce = _ref.debounce,\n      debounce = _ref$debounce === void 0 ? 200 : _ref$debounce,\n      _ref$cache = _ref.cache,\n      cache = _ref$cache === void 0 ? 24 * 60 * 60 : _ref$cache,\n      _ref$cacheKey = _ref.cacheKey,\n      cacheKey = _ref$cacheKey === void 0 ? \"upa\" : _ref$cacheKey,\n      googleMaps = _ref.googleMaps,\n      callbackName = _ref.callbackName,\n      _ref$defaultValue = _ref.defaultValue,\n      defaultValue = _ref$defaultValue === void 0 ? \"\" : _ref$defaultValue,\n      _ref$initOnMount = _ref.initOnMount,\n      initOnMount = _ref$initOnMount === void 0 ? true : _ref$initOnMount;\n\n  var _useState = useState(false),\n      ready = _useState[0],\n      setReady = _useState[1];\n\n  var _useState2 = useState(defaultValue),\n      value = _useState2[0],\n      setVal = _useState2[1];\n\n  var _useState3 = useState({\n    loading: false,\n    status: \"\",\n    data: []\n  }),\n      suggestions = _useState3[0],\n      setSuggestions = _useState3[1];\n\n  var asRef = useRef();\n  var requestOptionsRef = useLatest(requestOptions);\n  var googleMapsRef = useLatest(googleMaps);\n  var init = useCallback(function () {\n    var _google$maps;\n\n    if (asRef.current) return;\n    var _window = window,\n        google = _window.google;\n    var gMaps = googleMapsRef.current;\n    var placesLib = (gMaps == null ? void 0 : gMaps.places) || (google == null ? void 0 : (_google$maps = google.maps) == null ? void 0 : _google$maps.places);\n\n    if (!placesLib) {\n      console.error(loadApiErr);\n      return;\n    }\n\n    asRef.current = new placesLib.AutocompleteService();\n    setReady(true);\n  }, [googleMapsRef]);\n  var clearSuggestions = useCallback(function () {\n    setSuggestions({\n      loading: false,\n      status: \"\",\n      data: []\n    });\n  }, []);\n  var clearCache = useCallback(function (key) {\n    if (key === void 0) {\n      key = cacheKey;\n    }\n\n    try {\n      sessionStorage.removeItem(key);\n    } catch (error) {// Skip exception\n    }\n  }, [cacheKey]); // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  var fetchPredictions = useCallback(_debounce(function (val) {\n    var _asRef$current;\n\n    if (!val) {\n      clearSuggestions();\n      return;\n    }\n\n    setSuggestions(function (prevState) {\n      return _extends({}, prevState, {\n        loading: true\n      });\n    });\n    var cachedData = {};\n\n    try {\n      cachedData = JSON.parse(sessionStorage.getItem(cacheKey) || \"{}\");\n    } catch (error) {// Skip exception\n    }\n\n    if (cache) {\n      cachedData = Object.keys(cachedData).reduce(function (acc, key) {\n        if (cachedData[key].maxAge - Date.now() >= 0) acc[key] = cachedData[key];\n        return acc;\n      }, {});\n\n      if (cachedData[val]) {\n        setSuggestions({\n          loading: false,\n          status: \"OK\",\n          data: cachedData[val].data\n        });\n        return;\n      }\n    }\n\n    (_asRef$current = asRef.current) == null ? void 0 : _asRef$current.getPlacePredictions(_extends({}, requestOptionsRef.current, {\n      input: val\n    }), function (data, status) {\n      setSuggestions({\n        loading: false,\n        status: status,\n        data: data || []\n      });\n\n      if (cache && status === \"OK\") {\n        cachedData[val] = {\n          data: data,\n          maxAge: Date.now() + cache * 1000\n        };\n\n        try {\n          sessionStorage.setItem(cacheKey, JSON.stringify(cachedData));\n        } catch (error) {// Skip exception\n        }\n      }\n    });\n  }, debounce), [cache, cacheKey, clearSuggestions, requestOptionsRef]);\n  var setValue = useCallback(function (val, shouldFetchData) {\n    if (shouldFetchData === void 0) {\n      shouldFetchData = true;\n    }\n\n    setVal(val);\n    if (asRef.current && shouldFetchData) fetchPredictions(val);\n  }, [fetchPredictions]);\n  useEffect(function () {\n    if (!initOnMount) return function () {\n      return null;\n    };\n    var _window2 = window,\n        google = _window2.google;\n\n    if (!googleMapsRef.current && !(google != null && google.maps) && callbackName) {\n      window[callbackName] = init;\n    } else {\n      init();\n    }\n\n    return function () {\n      // @ts-ignore\n      if (window[callbackName]) delete window[callbackName];\n    };\n  }, [callbackName, googleMapsRef, init, initOnMount]);\n  return {\n    ready: ready,\n    value: value,\n    suggestions: suggestions,\n    setValue: setValue,\n    clearSuggestions: clearSuggestions,\n    clearCache: clearCache,\n    init: init\n  };\n};\n\n/* eslint-disable compat/compat */\nvar geocodeErr = \"ðŸ’¡ use-places-autocomplete: Please provide an address when using getGeocode() with the componentRestrictions.\";\nvar getGeocode = function getGeocode(args) {\n  var geocoder = new window.google.maps.Geocoder();\n  return new Promise(function (resolve, reject) {\n    geocoder.geocode(args, function (results, status) {\n      if (status !== \"OK\") reject(status);\n\n      if (!args.address && args.componentRestrictions) {\n        console.error(geocodeErr);\n        resolve(results);\n      }\n\n      resolve(results);\n    });\n  });\n};\nvar getLatLng = function getLatLng(result) {\n  var _result$geometry$loca = result.geometry.location,\n      lat = _result$geometry$loca.lat,\n      lng = _result$geometry$loca.lng;\n  return {\n    lat: lat(),\n    lng: lng()\n  };\n};\nvar getZipCode = function getZipCode(result, useShortName) {\n  var foundZip = result.address_components.find(function (_ref) {\n    var types = _ref.types;\n    return types.includes(\"postal_code\");\n  });\n  if (!foundZip) return undefined;\n  return useShortName ? foundZip.short_name : foundZip.long_name;\n};\nvar getDetailsErr = \"ðŸ’¡ use-places-autocomplete: Please provide a place Id when using getDetails() either as a string or as part of an Autocomplete Prediction.\";\nvar getDetails = function getDetails(args) {\n  var PlacesService = new window.google.maps.places.PlacesService(document.createElement(\"div\"));\n\n  if (!args.placeId) {\n    console.error(getDetailsErr);\n    return Promise.reject(getDetailsErr);\n  }\n\n  return new Promise(function (resolve, reject) {\n    PlacesService.getDetails(args, function (results, status) {\n      if (status !== \"OK\") reject(status);\n      resolve(results);\n    });\n  });\n};\n\nexport { usePlacesAutocomplete as default, getDetails, getGeocode, getLatLng, getZipCode };\n//# sourceMappingURL=index.esm.js.map\n","//import {ChangeEvent, useRef, useState} from \"react\";\nimport usePlacesAutocomplete from \"use-places-autocomplete\";\nimport \"./FormLocation.css\";\n\nexport interface FormLocationProps {\n    //id: string;\n    //apiKey: string;\n    //initialValue?: string;\n    labelText?: string;\n    //name: string;\n    onChange: (value: string) => any;\n    //placeholder?: string;\n}\n\nexport const FormLocation = ({\n                                 //id,\n                                 //apiKey,\n                                 labelText,\n                                 //name,\n                                 onChange,\n                                 //placeholder\n            }: FormLocationProps) => {\n\n    //Note: Code taken and modified from public usePlacesAutocomplete docs\n    //Link found here: https://www.npmjs.com/package/use-places-autocomplete\n    const { value, suggestions: { status, data }, setValue, clearSuggestions }  = usePlacesAutocomplete();\n\n\n    const handleInput = (e: any) => {\n        setValue(e.target.value);\n        onChange(e.target.value);\n    };\n\n    const handleSelect = ({ description }: {description: string}) => () => {\n        setValue(description, false);\n        onChange(description);\n        clearSuggestions();\n    };\n\n    const renderSuggestions = () =>\n         data.map((suggestion: any) => {\n             const {\n                 place_id,\n                 structured_formatting: { main_text, secondary_text },\n             } = suggestion;\n            console.log(suggestion);\n             return (\n                 <div className=\"autocomplete-suggestion\">\n                     <li className=\"listing-format\" key={place_id} onClick={handleSelect(suggestion)}>\n                         <strong>{main_text}</strong> <small>{secondary_text}</small>\n                     </li>\n                 </div>\n             );\n         });\n\n        return (\n            <div>\n                <label>{labelText}</label>\n                <input className=\"location-input\" value={value} onChange={handleInput} />\n                {status === 'OK' && <ul>{renderSuggestions()}</ul>}\n            </div>\n        );\n\n}\n\n"],"names":["_extends","target","i","source","key","__name","useLatest","val","ref","useRef","_debounce","fn","delay","timer","_this","_len","args","_key","loadApiErr","usePlacesAutocomplete","_temp","_ref","requestOptions","_ref$debounce","debounce","_ref$cache","cache","_ref$cacheKey","cacheKey","googleMaps","callbackName","_ref$defaultValue","defaultValue","_ref$initOnMount","initOnMount","_useState","useState","ready","setReady","_useState2","value","setVal","_useState3","suggestions","setSuggestions","asRef","requestOptionsRef","googleMapsRef","init","useCallback","_google$maps","_window","google","gMaps","placesLib","clearSuggestions","clearCache","fetchPredictions","_asRef$current","prevState","cachedData","acc","data","status","setValue","shouldFetchData","useEffect","_window2","FormLocation","labelText","handleInput","e","onChange","handleSelect","description","_jsxs","_jsx","suggestion","place_id","main_text","secondary_text","console"],"mappings":"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"}